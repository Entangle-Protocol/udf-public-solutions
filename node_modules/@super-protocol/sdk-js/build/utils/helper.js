"use strict";
var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
exports.executeBatchAsync = exports.transformComplexObject = exports.cleanWeb3Data = exports.isValidBytes32Hex = exports.packSlotInfo = exports.unpackSlotInfo = exports.formatOptionInfo = exports.formatUsage = exports.formatOfferSlot = exports.formatTeeOfferSlot = exports.formatTeeOfferOption = exports.convertBigIntToString = exports.unpackDeviceId = exports.packDeviceId = exports.incrementMethodCall = exports.isNodeJS = exports.createTransactionOptions = exports.multiplyBigIntByNumber = exports.getGasPrice = exports.checkForUsingExternalTxManager = exports.checkIfActionAccountInitialized = void 0;
const store_1 = __importDefault(require("../store"));
const Monitoring_1 = require("./Monitoring");
const constants_1 = require("../constants");
/**
 * Function for checking if provider action account initialized (required for set methods)
 * Used in all set methods
 */
const checkIfActionAccountInitialized = (transactionOptions) => {
    if (!store_1.default.actionAccount && !(transactionOptions === null || transactionOptions === void 0 ? void 0 : transactionOptions.web3))
        throw new Error("Provider action account is not initialized, needs to run 'BlockchainConnector.getInstance().initializeActionAccount(SECRET_KEY)' first");
};
exports.checkIfActionAccountInitialized = checkIfActionAccountInitialized;
/**
 * Function for checking if current configuration supposed to use external transaction manager like MetaMask and etc.
 */
const checkForUsingExternalTxManager = (transactionOptions) => {
    // TODO: Agree on more proper way of signaling, that we use an external transaction manager, than just passing a web3 instance.
    return !!(transactionOptions === null || transactionOptions === void 0 ? void 0 : transactionOptions.web3);
};
exports.checkForUsingExternalTxManager = checkForUsingExternalTxManager;
/**
 * Updates gas price determined by the last few blocks median
 */
const getGasPrice = (web3) => {
    return web3.eth.getGasPrice();
};
exports.getGasPrice = getGasPrice;
const multiplyBigIntByNumber = (big, num) => {
    const factor = BigInt(Math.pow(10, (num.toString().split('.')[1] || '').length));
    const result = big * BigInt(Math.round(num * Number(factor)));
    return result / factor;
};
exports.multiplyBigIntByNumber = multiplyBigIntByNumber;
/**
 * Merge transaction options from arguments and from store
 * Used in all set methods
 */
const createTransactionOptions = (options) => __awaiter(void 0, void 0, void 0, function* () {
    if (!options)
        options = {};
    if (!options.from)
        options.from = store_1.default.actionAccount;
    if (!options.gas)
        options.gas = store_1.default.gasLimit;
    if (!options.gasPriceMultiplier)
        options.gasPriceMultiplier = store_1.default.gasPriceMultiplier;
    if (!options.gasPrice) {
        const web3 = options.web3 || store_1.default.web3Https;
        if (!web3) {
            throw Error('web3 is undefined, define it in transaction options or initialize BlockchainConnector with web3 instance.');
        }
        try {
            options.gasPrice = yield (0, exports.getGasPrice)(web3);
        }
        catch (e) {
            options.gasPrice = store_1.default.gasPrice;
        }
    }
    delete options.web3;
    return options;
});
exports.createTransactionOptions = createTransactionOptions;
const isNodeJS = () => {
    return typeof window === 'undefined';
};
exports.isNodeJS = isNodeJS;
function incrementMethodCall() {
    return function (_target, propertyName, propertyDescriptor) {
        const monitoring = Monitoring_1.Monitoring.getInstance();
        const method = propertyDescriptor.value;
        propertyDescriptor.value = function (...args) {
            monitoring.incrementCall(propertyName);
            return method.apply(this, args);
        };
        return propertyDescriptor;
    };
}
exports.incrementMethodCall = incrementMethodCall;
function packDeviceId(hexedDeviceId) {
    const hexRegex = /^[0-9a-fA-F]+$/;
    if (hexedDeviceId.length !== 64) {
        throw new Error('DeviceId must be equal 64 hex symbols');
    }
    if (!hexRegex.test(hexedDeviceId)) {
        throw new Error('DeviceId must be a hexedecimal');
    }
    return '0x' + hexedDeviceId;
}
exports.packDeviceId = packDeviceId;
function unpackDeviceId(bytes32) {
    if (bytes32.length !== 66) {
        throw new Error('DeviceId bytes must be equal 66 symbols');
    }
    // removes '0x'
    return bytes32.slice(2, 66);
}
exports.unpackDeviceId = unpackDeviceId;
function convertBigIntToString(obj) {
    if (typeof obj === 'bigint') {
        return obj.toString(); // Convert BigInt to string
    }
    else if (typeof obj === 'object') {
        if (Array.isArray(obj)) {
            // If it's an array, map each element
            return obj.map((item) => convertBigIntToString(item));
        }
        else {
            // If it's an object, recursively convert its properties
            const convertedObj = {};
            for (const key in obj) {
                if (obj.hasOwnProperty(key)) {
                    convertedObj[key] = convertBigIntToString(obj[key]);
                }
            }
            return convertedObj;
        }
    }
    else {
        return obj; // Leave other types unchanged
    }
}
exports.convertBigIntToString = convertBigIntToString;
function formatTeeOfferOption(option) {
    option = (0, exports.cleanWeb3Data)(option);
    return Object.assign(Object.assign({}, option), { info: formatOptionInfo(option.info), usage: formatUsage(option.usage) });
}
exports.formatTeeOfferOption = formatTeeOfferOption;
function formatTeeOfferSlot(slot, cpuDenominator) {
    slot = (0, exports.cleanWeb3Data)(slot);
    return Object.assign(Object.assign({}, slot), { info: unpackSlotInfo(slot.info, cpuDenominator), usage: formatUsage(slot.usage) });
}
exports.formatTeeOfferSlot = formatTeeOfferSlot;
function formatOfferSlot(slot, cpuDenominator) {
    slot = (0, exports.cleanWeb3Data)(slot);
    return Object.assign(Object.assign({}, slot), { option: formatOptionInfo(slot.option), info: unpackSlotInfo(slot.info, cpuDenominator), usage: formatUsage(slot.usage) });
}
exports.formatOfferSlot = formatOfferSlot;
function formatUsage(usage) {
    return {
        priceType: usage.priceType.toString(),
        price: usage.price,
        minTimeMinutes: Number(usage.minTimeMinutes),
        maxTimeMinutes: Number(usage.maxTimeMinutes),
    };
}
exports.formatUsage = formatUsage;
function formatOptionInfo(optionInfo) {
    optionInfo = (0, exports.cleanWeb3Data)(optionInfo);
    return {
        bandwidth: Number(optionInfo.bandwidth),
        traffic: Number(optionInfo.traffic),
        externalPort: Number(optionInfo.externalPort),
    };
}
exports.formatOptionInfo = formatOptionInfo;
function unpackSlotInfo(slotInfo, cpuDenominator) {
    return {
        cpuCores: Number(slotInfo.cpuCores) / cpuDenominator,
        ram: Number(slotInfo.ram),
        diskUsage: Number(slotInfo.diskUsage),
    };
}
exports.unpackSlotInfo = unpackSlotInfo;
function packSlotInfo(slotInfo, cpuDenominator) {
    return {
        cpuCores: slotInfo.cpuCores * cpuDenominator,
        ram: slotInfo.ram,
        diskUsage: slotInfo.diskUsage,
    };
}
exports.packSlotInfo = packSlotInfo;
function isValidBytes32Hex(data) {
    const regex = /^0x[a-fA-F0-9]{64}$/;
    return regex.test(data);
}
exports.isValidBytes32Hex = isValidBytes32Hex;
const cleanWeb3Data = (data) => {
    var _a;
    const result = {};
    for (const key in data) {
        // If the value of the current key is an object (but not an array or null), recursively clean it
        if (typeof data[key] === 'object' && data[key] !== null && !Array.isArray(data[key])) {
            result[key] = (0, exports.cleanWeb3Data)(data[key]);
            result[key] = convertBigIntToString(result[key]);
        }
        else if (Array.isArray(data[key])) {
            result[key] = data[key].map((item) => typeof item === 'bigint' ? item.toString() : item);
        }
        else if (typeof data[key] === 'bigint') {
            result[key] = data[key].toString();
        }
        else {
            result[key] = data[key];
        }
    }
    // Remove __length__ and numbered properties
    delete result.__length__;
    for (let i = 0; i < ((_a = data.__length__) !== null && _a !== void 0 ? _a : 0); i++) {
        delete result[i.toString()];
    }
    return result;
};
exports.cleanWeb3Data = cleanWeb3Data;
const transformComplexObject = (obj) => {
    const result = {};
    for (const [key, value] of Object.entries(obj)) {
        if (!isNaN(Number(key))) {
            continue;
        }
        if (Array.isArray(value)) {
            result[key] = {};
            for (const [innerKey, innerValue] of Object.entries(value)) {
                if (!isNaN(Number(innerKey))) {
                    continue;
                }
                result[key][innerKey] = innerValue;
            }
        }
        else {
            result[key] = value;
        }
    }
    return result;
};
exports.transformComplexObject = transformComplexObject;
const executeBatchAsync = (batch, timeout = constants_1.BLOCKCHAIN_BATCH_REQUEST_TIMEOUT) => __awaiter(void 0, void 0, void 0, function* () {
    const result = [];
    const responses = yield batch.execute({ timeout });
    for (const response of responses) {
        if ('error' in response) {
            throw new Error(response.error.message);
        }
        else {
            result.push(response.result);
        }
    }
    return result;
});
exports.executeBatchAsync = executeBatchAsync;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaGVscGVyLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vc3JjL3V0aWxzL2hlbHBlci50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7QUFBQSxxREFBNkI7QUFJN0IsNkNBQTBDO0FBVTFDLDRDQUFnRTtBQUVoRTs7O0dBR0c7QUFDSSxNQUFNLCtCQUErQixHQUFHLENBQUMsa0JBQXVDLEVBQVEsRUFBRTtJQUMvRixJQUFJLENBQUMsZUFBSyxDQUFDLGFBQWEsSUFBSSxDQUFDLENBQUEsa0JBQWtCLGFBQWxCLGtCQUFrQix1QkFBbEIsa0JBQWtCLENBQUUsSUFBSSxDQUFBO1FBQ25ELE1BQU0sSUFBSSxLQUFLLENBQ2Isd0lBQXdJLENBQ3pJLENBQUM7QUFDTixDQUFDLENBQUM7QUFMVyxRQUFBLCtCQUErQixtQ0FLMUM7QUFFRjs7R0FFRztBQUNJLE1BQU0sOEJBQThCLEdBQUcsQ0FDNUMsa0JBQXVDLEVBQzlCLEVBQUU7SUFDWCwrSEFBK0g7SUFDL0gsT0FBTyxDQUFDLENBQUMsQ0FBQSxrQkFBa0IsYUFBbEIsa0JBQWtCLHVCQUFsQixrQkFBa0IsQ0FBRSxJQUFJLENBQUEsQ0FBQztBQUNwQyxDQUFDLENBQUM7QUFMVyxRQUFBLDhCQUE4QixrQ0FLekM7QUFFRjs7R0FFRztBQUNJLE1BQU0sV0FBVyxHQUFHLENBQUMsSUFBVSxFQUFtQixFQUFFO0lBQ3pELE9BQU8sSUFBSSxDQUFDLEdBQUcsQ0FBQyxXQUFXLEVBQUUsQ0FBQztBQUNoQyxDQUFDLENBQUM7QUFGVyxRQUFBLFdBQVcsZUFFdEI7QUFFSyxNQUFNLHNCQUFzQixHQUFHLENBQUMsR0FBVyxFQUFFLEdBQVcsRUFBVSxFQUFFO0lBQ3pFLE1BQU0sTUFBTSxHQUFHLE1BQU0sQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLEVBQUUsRUFBRSxDQUFDLEdBQUcsQ0FBQyxRQUFRLEVBQUUsQ0FBQyxLQUFLLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFD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