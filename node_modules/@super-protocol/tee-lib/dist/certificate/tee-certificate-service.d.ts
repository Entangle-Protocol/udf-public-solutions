/// <reference types="node" />
import { pki } from 'node-forge';
import { GenerateTLSCertParams, GenerateTlsCertResult, ITeeCertificateService, TeeCertificateServiceParams, GenerateCsrParams, GeneratedCsr } from './interfaces';
import { ParseTlsCertificateResult } from '../tee-device';
declare module 'node-forge' {
    namespace pki {
        interface CertificateRequest extends Certificate {
            setAttributes(opts: Record<string, unknown>[]): void;
        }
    }
}
export declare class TeeCertificateService implements ITeeCertificateService {
    static readonly certOidQuote = "0.6.9.42.840.113741.1337.6";
    private readonly caStore;
    private readonly logger?;
    private readonly pkiService;
    private readonly teeDevice;
    constructor(params: TeeCertificateServiceParams);
    static parseCertificate(contentDerOrPem: Buffer): Promise<pki.Certificate>;
    verifyCertificate(cert: string | Buffer[]): Promise<boolean>;
    verifyTlsCertificateChain(certChainInPem: string | Buffer): Promise<string | null>;
    verifyTlsCertificateHostname(certChainInPem: string | Buffer, hostnameOrIp: string): Promise<boolean>;
    parseAndValidateTlsCertificate(cert: Buffer): Promise<ParseTlsCertificateResult>;
    generateQuote(publicKey: pki.PublicKey): Promise<Buffer>;
    generateCsr(params: GenerateCsrParams): Promise<GeneratedCsr>;
    generateTlsCertificate(params?: GenerateTLSCertParams): Promise<GenerateTlsCertResult>;
}
